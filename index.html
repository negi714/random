<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>unko</title>
    </head>
    <style>
        .input {
            margin: 0;
            position: absolute;
            width: 85%;
            font-size: 7rem;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 
            Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            text-align: center;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);		
            outline: none;
        }
        .dark {
            background-color: black;
            color: #e6e6e6;
        }
        .wpm {
            position: fixed;
            visibility: hidden;
            font-family: "Lato";
            font-size: 7rem;
            font-style: italic;
            display: flex;
            width: 99%;
            height: 173%;
            justify-content: center;
            text-align: center;
            align-items: center;
        }
        .wpmstat {
            position: fixed;
            visibility: hidden;
            bottom: 17px;
            left: 48%;
            font-family: "Lato";
            font-size: 2rem;
        }
        .lato-regular {
            font-family: "Lato", sans-serif;
            font-weight: 400;
            font-style: normal;
        }
    </style>
    <body>
        <div class="input" contenteditable="true"></div>
        <div class="wpm">0</div>
        <div class="wpmstat"><i>wpm</i></div>
    </body>
    <script>
        document.querySelector(".input").focus();

        function darkMode() {
            let element = document.body;
            element.classList.toggle("dark");
        }

        let text = document.querySelector(".input");

        function saveInput() {
            let valueinput = text.innerText

            let blobdtMIME = new Blob([valueinput], { type: "text/plain" })
            let url = URL.createObjectURL(blobdtMIME)
            let anele = document.createElement("a")
            anele.setAttribute("download", "namagawaki");
            anele.href = url;
            anele.click();
            console.log(blobdtMIME)
        }

        let textArea = document.querySelector(".input");
        let wpmDisplay = document.querySelector(".wpm");
        let wpmUnit = document.querySelector(".wpmstat");

        let startTime = null;
        let interval = null;
        let wpmEnabled = false;
        
        function calculateWPM() {
            let content = textArea.innerText.trim();
    
            // Calculate the number of words
            let words = content.split(/\s+/).filter(word => word.length > 0).length;

            // Convert ms to minutes
            let elapsedTime = (new Date().getTime() - startTime) / 60000;

            // Calculate WPM
            let wpm = elapsedTime > 0 ? Math.round(words / elapsedTime) : 0;

            // Update WPM display
            wpmDisplay.textContent = wpm;
        }

        textArea.addEventListener("input", () => {
            if (wpmEnabled) {
                if (!interval) {
                    startWPM();
                }
            }
        });

        function startWPM() {
            if (!startTime) {
                startTime = new Date().getTime();
            }
            if (!interval) {
                interval = setInterval(calculateWPM, 1000);
            }
            wpmDisplay.style.visibility = "visible";
            wpmUnit.style.visibility = "visible";
        }

        function stopWPM() {
            clearInterval(interval);
            interval = null;
            startTime = null;
            wpmDisplay.textContent = 0; // Reset WPM display
            wpmDisplay.style.visibility = "hidden";
            wpmUnit.style.visibility = "hidden";
        }

        // Keyboard Shortcuts
        document.addEventListener('keydown', event => {
            // ctrl or cmd + B (dark mode)
            if ((event.ctrlKey || event.metaKey) && event.key === "1") {
                event.preventDefault(); // Prevents default browser shortcuts
                darkMode();
            } // ctrl or cmd + J (save file)
            else if ((event.ctrlKey || event.metaKey) && event.key === "2") {
                event.preventDefault();
                saveInput();
            } // ctrl or cmd + K (speedometer)
            else if ((event.ctrlKey || event.metaKey) && event.key === "3") {
                event.preventDefault();
                wpmEnabled = !wpmEnabled;
                if (wpmEnabled) {
                    startWPM();
                } else {
                    stopWPM();
                }
            } // ctrl or cmd + K (prank)
            else if ((event.ctrlKey || event.metaKey) && event.key === "4") {
                event.preventDefault();
                window.open("https://www.youtube.com/watch?v=At8v_Yc044Y&t=57s", "_blank");
            }
        });
    </script>
</html>
